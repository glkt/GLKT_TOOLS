# GLKT / Benjamin Vedrenne
# MIT License

# This script create a write node under each selected read nodes. Easy for fast and massive file conversion TO VIDEO : APPLE PRORES 444.

osdir = nuke.getClipname( "Where to save png sequence?" )

for oReadNode in nuke.selectedNodes():

    oPath =  oReadNode['file'].value()
    first =  oReadNode['first'].value()
    last =  oReadNode['last'].value()
    newPath = oPath.split('/')[-2]
    newPath = newPath.replace(".%03d.png","")
    oReadNode['selected'].setValue(True)
    Write = nuke.createNode ("Write")    

   
    Write.knob('file').setValue(osdir+newPath+".mov") 
    Write.knob('file_type').setValue('mov')
    Write.knob('codec').setValue('mp4v')
    Write.knob('fps').setValue(25)
    Write.knob('quality').setValue('High')
    Write.knob('use_limit').setValue(True)
    Write.knob('first').setValue(first)
    Write.knob('last').setValue(last)
    Write.knob('settings').setValue('000000000000000000000000000001e37365616e000000010000000100000000000001cf76696465000000010000000f00000000000000227370746c0000000100000000000000006d70347600000000001800000400000000207470726c0000000100000000000000000000020000190000000000020000002464726174000000010000000000000000004e2000000000530000010000000100000000156d70736f00000001000000000000000000000000186d66726100000001000000000000000000000000000000187073667200000001000000000000000000000000000000156266726100000001000000000000000000000000166d70657300000001000000000000000000000000002868617264000000010000000000000000000000000000000000000000000000000000000000000016656e647300000001000000000000000000000000001663666c67000000010000000000000000004400000018636d66720000000100000000000000006170706c00000014636c75740000000100000000000000000000004963646563000000010000000000000000000000000000000000000000000000297365616e000000010000000100000000000000156d6f6465000000010000000000000000020000001c766572730000000100000000000000000003001c00010000')

# this is to get advanced codec settings. Copy the long string returned

i = nuke.selectedNode()

print i.knob('settings').value()

